# [Silver III] 반짝반짝 빛나는 별가루 - 30677 

[문제 링크](https://www.acmicpc.net/problem/30677) 

### 성능 요약

메모리: 45684 KB, 시간: 188 ms

### 분류

구현, 수학

### 제출 일자

2023년 11월 18일 22:56:32

### 문제 설명

<p>스타는 별가루를 만드는 마법 연습을 하는 중이다. 본인의 실력을 시험하기 위해 하루에 한 번씩, 총 $N$일 동안 마법을 사용하여 별가루를 얼마나 만들 수 있는지 확인하고자 했고 $N$일 동안의 계획을 세웠다.</p>

<p>스타는 별가루를 만들 수 있는 $K$가지의 마법을 사용할 수 있다. 각각의 마법을 $1$번 마법, $2$번 마법, ... , $K$번 마법이라고 부르기로 하자.</p>

<p>$i$번 마법을 사용해서 만들 수 있는 별가루의 개수는 다음과 같다.</p>

<p style="text-align: center;">$\Delta Stardust = \lfloor base_i(1+\frac{combo \cdot C}{100})(1+\frac{skill_i \cdot s_i}{100}) \rfloor$</p>

<p>식에 대한 설명은 다음과 같다.</p>

<ul>
	<li>$\Delta Stardust$: 만들어진 별가루의 개수이다.</li>
	<li>$base_i$: $i$번 마법을 사용해서 기본적으로 만들 수 있는 별가루의 개수이다.</li>
	<li>$combo$: 연속으로 마법을 사용한 횟수이다. 예를 들어, 오늘 마법을 사용하기 전에 마법을 $5$일 연속으로 사용했다면 $combo = 5$이다.</li>
	<li>$skill_i$: $i$번 마법의 숙련도이다. 예를 들어, 오늘 마법을 사용하기 전에 $i$번 마법을 사용한 경험이 $3$번 있으면 $skill_i = 3$이다.</li>
	<li>$C$와 $s_i$는 상수이다.</li>
</ul>

<p>스타의 초기 피로도는 $0$이며, $i$번 마법을 사용할 때마다 스타의 피로도는 $p_i$만큼 상승한다. 피로도가 $100$을 초과하게 되면, 마법봉이 망가지고 이후에는 어떤 마법도 쓸 수 없게 된다. 동시에, 지금까지 만들었던 별가루도 못 쓰게 된다. 피로도는 휴식을 통해 줄일 수 있다. 휴식을 취하면 피로도가 $R$만큼 줄어들지만, 연속으로 마법을 사용한 횟수는 $0$이 된다. 피로도는 $0$ 미만으로 내려가지 않으며, 만약 휴식으로 감소하는 피로도가 현재 피로도보다 크다면 피로도는 $0$이 된다.</p>

<p>스타의 계획을 보고 $N$일 동안 만들 수 있는 별가루의 총 개수를 계산해 보자.</p>

### 입력 

 <p>첫째 줄에는 $N,K,C,R$ 이 공백을 사이에 두고 주어진다. $(1 \leq K \leq N \leq 100 \, 000;$ $1 \leq C \leq 100;$ $1 \leq R \leq 100)$</p>

<p>둘째 줄에는 $base_1, \cdots , base_K$가 공백을 사이에 두고 주어진다. $(1 \leq base_i \leq 100 \, 000)$</p>

<p>셋째 줄에는 $s_1, \cdots , s_K$가 공백을 사이에 두고 주어진다. $(1 \leq s_i \leq 100)$</p>

<p>넷째 줄에는 $p_1, \cdots ,p_K$가 공백을 사이에 두고 주어진다. $(1 \leq p_i \leq 100)$</p>

<p>다섯째 줄부터 $N$개의 줄에 걸쳐 스타가 $i$번째 날에 사용하려고 계획한 마법의 번호 $l_i \ (0 \leq l_i \leq K)$가 한 줄에 하나씩 주어진다. $l_i$가 $0$이면 그날 하루는 휴식을 취한다는 뜻이다.</p>

<p>입력으로 주어지는 모든 수는 정수이다.</p>

### 출력 

 <p>$N$일 동안 만들 수 있는 별가루의 총 개수를 출력한다. 계획 중간에 마법봉이 망가진다면 <span style="color:#d35400;"><code>-1</code></span>을 출력한다.</p>

